p8105_hw2_bx2232
================

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(lubridate)
library(readxl)
library(haven)
```

``` r
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

\#Problem 1 \# pols-month

``` r
pols_df <- read_csv("fivethirtyeight_datasets/pols-month.csv", na = c("NA", ".", "")) %>% 
  janitor::clean_names() %>% 
  separate(mon, into = c("year", "month", "day"), sep = "-") %>% 
  mutate(
    year = as.integer(year),
    month = factor(month.name[as.integer(month)],
                   levels = month.name,
                   ordered = TRUE),
    president = case_when(
      prez_dem == 1 ~ "dem",
      prez_gop == 1 ~ "gop",
      TRUE ~ NA_character_
    )
  ) %>% 
  select(-prez_dem, -prez_gop, -day) %>% 
  select(year, month, everything())

pols_df
```

    ## # A tibble: 822 × 9
    ##     year month     gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##    <int> <ord>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ##  1  1947 January        23      51     253      23      45     198 dem      
    ##  2  1947 February       23      51     253      23      45     198 dem      
    ##  3  1947 March          23      51     253      23      45     198 dem      
    ##  4  1947 April          23      51     253      23      45     198 dem      
    ##  5  1947 May            23      51     253      23      45     198 dem      
    ##  6  1947 June           23      51     253      23      45     198 dem      
    ##  7  1947 July           23      51     253      23      45     198 dem      
    ##  8  1947 August         23      51     253      23      45     198 dem      
    ##  9  1947 September      23      51     253      23      45     198 dem      
    ## 10  1947 October        23      51     253      23      45     198 dem      
    ## # ℹ 812 more rows

\#snp

``` r
snp_df <- read_csv("fivethirtyeight_datasets/snp.csv", na = c("NA", ".", "")) %>% 
  janitor::clean_names() %>% 
  separate(date, into = c("year", "month", "day"), sep = "-") %>% 
  mutate(
    year = as.integer(year),
    month = factor(month.name[as.integer(month)],
                   levels = month.name,
                   ordered = TRUE)
  ) %>% 
  select(year, month, close) %>% 
  arrange(year, month)

snp_df
```

    ## # A tibble: 787 × 3
    ##     year month close
    ##    <int> <ord> <dbl>
    ##  1    NA <NA>  2080.
    ##  2    NA <NA>  2063.
    ##  3    NA <NA>  2107.
    ##  4    NA <NA>  2086.
    ##  5    NA <NA>  2068.
    ##  6    NA <NA>  2104.
    ##  7    NA <NA>  1995.
    ##  8    NA <NA>  2059.
    ##  9    NA <NA>  2068.
    ## 10    NA <NA>  2018.
    ## # ℹ 777 more rows

\#unemployment

``` r
unemp_df <- read_csv("fivethirtyeight_datasets/unemployment.csv", na = c("NA", ".", "")) %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    cols = -year,
    names_to = "month",
    values_to = "unemployment"
  ) %>% 
  mutate(
    year = as.integer(year),
    month = factor(
      month.name[match(month, tolower(month.abb))],
      levels = month.name,
      ordered = TRUE
    )
  ) %>% 
  arrange(year, month)

unemp_df
```

    ## # A tibble: 816 × 3
    ##     year month     unemployment
    ##    <int> <ord>            <dbl>
    ##  1  1948 January            3.4
    ##  2  1948 February           3.8
    ##  3  1948 March              4  
    ##  4  1948 April              3.9
    ##  5  1948 May                3.5
    ##  6  1948 June               3.6
    ##  7  1948 July               3.6
    ##  8  1948 August             3.9
    ##  9  1948 September          3.8
    ## 10  1948 October            3.7
    ## # ℹ 806 more rows

\#join all data together

``` r
merged_df <- pols_df %>% 
  left_join(snp_df,  by = c("year","month")) %>% 
  left_join(unemp_df, by = c("year","month")) %>% 
  arrange(year, month)

merged_df
```

    ## # A tibble: 822 × 11
    ##     year month   gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##    <int> <ord>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ##  1  1947 January      23      51     253      23      45     198 dem          NA
    ##  2  1947 Februa…      23      51     253      23      45     198 dem          NA
    ##  3  1947 March        23      51     253      23      45     198 dem          NA
    ##  4  1947 April        23      51     253      23      45     198 dem          NA
    ##  5  1947 May          23      51     253      23      45     198 dem          NA
    ##  6  1947 June         23      51     253      23      45     198 dem          NA
    ##  7  1947 July         23      51     253      23      45     198 dem          NA
    ##  8  1947 August       23      51     253      23      45     198 dem          NA
    ##  9  1947 Septem…      23      51     253      23      45     198 dem          NA
    ## 10  1947 October      23      51     253      23      45     198 dem          NA
    ## # ℹ 812 more rows
    ## # ℹ 1 more variable: unemployment <dbl>

``` r
summary(pols_df)
```

    ##       year           month        gov_gop         sen_gop        rep_gop     
    ##  Min.   :1947   January : 69   Min.   :12.00   Min.   :32.0   Min.   :141.0  
    ##  1st Qu.:1964   February: 69   1st Qu.:18.00   1st Qu.:42.0   1st Qu.:176.0  
    ##  Median :1981   March   : 69   Median :22.00   Median :46.0   Median :195.0  
    ##  Mean   :1981   April   : 69   Mean   :22.48   Mean   :46.1   Mean   :194.9  
    ##  3rd Qu.:1998   May     : 69   3rd Qu.:28.00   3rd Qu.:51.0   3rd Qu.:222.0  
    ##  Max.   :2015   June    : 69   Max.   :34.00   Max.   :56.0   Max.   :253.0  
    ##                 (Other) :408                                                 
    ##     gov_dem        sen_dem         rep_dem     president        
    ##  Min.   :17.0   Min.   :44.00   Min.   :188   Length:822        
    ##  1st Qu.:22.0   1st Qu.:48.00   1st Qu.:211   Class :character  
    ##  Median :28.0   Median :53.00   Median :250   Mode  :character  
    ##  Mean   :27.2   Mean   :54.41   Mean   :245                     
    ##  3rd Qu.:32.0   3rd Qu.:58.00   3rd Qu.:268                     
    ##  Max.   :41.0   Max.   :71.00   Max.   :301                     
    ## 

``` r
summary(snp_df)
```

    ##       year          month         close        
    ##  Min.   : NA   January :  0   Min.   :  17.05  
    ##  1st Qu.: NA   February:  0   1st Qu.:  83.73  
    ##  Median : NA   March   :  0   Median : 138.53  
    ##  Mean   :NaN   April   :  0   Mean   : 474.89  
    ##  3rd Qu.: NA   May     :  0   3rd Qu.: 941.80  
    ##  Max.   : NA   (Other) :  0   Max.   :2107.39  
    ##  NA's   :787   NA's    :787

``` r
summary(unemp_df)
```

    ##       year           month      unemployment  
    ##  Min.   :1948   January : 68   Min.   : 2.50  
    ##  1st Qu.:1965   February: 68   1st Qu.: 4.70  
    ##  Median :1982   March   : 68   Median : 5.60  
    ##  Mean   :1982   April   : 68   Mean   : 5.83  
    ##  3rd Qu.:1998   May     : 68   3rd Qu.: 6.90  
    ##  Max.   :2015   June    : 68   Max.   :10.80  
    ##                 (Other) :408   NA's   :6

``` r
summary(merged_df)
```

    ##       year           month        gov_gop         sen_gop        rep_gop     
    ##  Min.   :1947   January : 69   Min.   :12.00   Min.   :32.0   Min.   :141.0  
    ##  1st Qu.:1964   February: 69   1st Qu.:18.00   1st Qu.:42.0   1st Qu.:176.0  
    ##  Median :1981   March   : 69   Median :22.00   Median :46.0   Median :195.0  
    ##  Mean   :1981   April   : 69   Mean   :22.48   Mean   :46.1   Mean   :194.9  
    ##  3rd Qu.:1998   May     : 69   3rd Qu.:28.00   3rd Qu.:51.0   3rd Qu.:222.0  
    ##  Max.   :2015   June    : 69   Max.   :34.00   Max.   :56.0   Max.   :253.0  
    ##                 (Other) :408                                                 
    ##     gov_dem        sen_dem         rep_dem     president             close    
    ##  Min.   :17.0   Min.   :44.00   Min.   :188   Length:822         Min.   : NA  
    ##  1st Qu.:22.0   1st Qu.:48.00   1st Qu.:211   Class :character   1st Qu.: NA  
    ##  Median :28.0   Median :53.00   Median :250   Mode  :character   Median : NA  
    ##  Mean   :27.2   Mean   :54.41   Mean   :245                      Mean   :NaN  
    ##  3rd Qu.:32.0   3rd Qu.:58.00   3rd Qu.:268                      3rd Qu.: NA  
    ##  Max.   :41.0   Max.   :71.00   Max.   :301                      Max.   : NA  
    ##                                                                  NA's   :822  
    ##   unemployment  
    ##  Min.   : 2.50  
    ##  1st Qu.: 4.70  
    ##  Median : 5.60  
    ##  Mean   : 5.83  
    ##  3rd Qu.: 6.90  
    ##  Max.   :10.80  
    ##  NA's   :12
